/*
|--------------------------------------------------------------------------------
| Insert: BCMA.BCMAMedicationLog.sql
|--------------------------------------------------------------------------------
| Insert test BCMA medication administration data
| BCMAMedicationLogSID => 9001 series
| Linked to existing inpatient stays (InpatientSID 1638001-1638008)
| Includes various action types: Given, Held, Refused, Missing Dose, etc.
|--------------------------------------------------------------------------------
*/

PRINT '==== BCMA.BCMAMedicationLog ====';
GO

-- Set the active database
USE CDWWork;
GO

-- Insert BCMA medication log data
INSERT INTO BCMA.BCMAMedicationLog
(
  BCMAMedicationLogSID, BCMAMedicationLogIEN, Sta3n, PatientSID, PatientIEN, InpatientSID, InpatientIEN, ActionType, ActionStatus, ActionDateTime, ActionVistaErrorDate, ActionDateTimeTransformSID, ScheduledDateTime, ScheduledVistaErrorDate, ScheduledDateTimeTransformSID, OrderedDateTime, OrderedVistaErrorDate, OrderedDateTimeTransformSID, AdministeredByStaffSID, AdministeredByStaffIEN, OrderingProviderSID, OrderingProviderIEN, LocalDrugSID, LocalDrugIEN, NationalDrugSID, DrugNameWithoutDose, DrugNameWithDose, OrderNumber, DosageOrdered, DosageGiven, Route, RouteIEN, UnitOfAdministration, ScheduleType, Schedule, AdministrationUnit, WardLocationSID, WardLocationIEN, WardName, VarianceFlag, VarianceType, VarianceReason, VarianceComment, IVFlag, IVType, InfusionRate, TransactionDateTime, TransactionVistaErrorDate, TransactionDateTimeTransformSID
)
VALUES
-- Patient 1001 (InpatientSID 1638001) - Scheduled medications given
(9001, 'BCMALogIEN9001', 508, 1001, 'PtIEN1001', 1638001, 'PFIEN001', 'GIVEN', 'COMPLETED', '2025-01-01 08:05:00', NULL, NULL, '2025-01-01 08:00:00', NULL, NULL, '2025-01-01 03:45:00', NULL, NULL, 1001, 'StaffIEN1001', 1001, 'StaffIEN1001', 10002, 'DrugIEN10002', 20002, 'LISINOPRIL', 'LISINOPRIL 10MG TAB', 'IP-2025-001001', '10MG', '10MG', 'PO', 'RouteIEN01', 'TAB', 'SCHEDULED', 'QD', 'TAB', 2001, 'WardIEN2001', '4 WEST MEDICAL', 'N', NULL, NULL, NULL, 'N', NULL, NULL, '2025-01-01 08:05:00', NULL, NULL),
(9002, 'BCMALogIEN9002', 508, 1001, 'PtIEN1001', 1638001, 'PFIEN001', 'GIVEN', 'COMPLETED', '2025-01-01 12:10:00', NULL, NULL, '2025-01-01 12:00:00', NULL, NULL, '2025-01-01 03:45:00', NULL, NULL, 1002, 'StaffIEN1002', 1001, 'StaffIEN1001', 10001, 'DrugIEN10001', 20001, 'METFORMIN HCL', 'METFORMIN HCL 500MG TAB', 'IP-2025-001002', '500MG', '500MG', 'PO', 'RouteIEN01', 'TAB', 'SCHEDULED', 'BID', 'TAB', 2001, 'WardIEN2001', '4 WEST MEDICAL', 'N', NULL, NULL, NULL, 'N', NULL, NULL, '2025-01-01 12:10:00', NULL, NULL),
(9003, 'BCMALogIEN9003', 508, 1001, 'PtIEN1001', 1638001, 'PFIEN001', 'GIVEN', 'COMPLETED', '2025-01-01 18:08:00', NULL, NULL, '2025-01-01 18:00:00', NULL, NULL, '2025-01-01 03:45:00', NULL, NULL, 1001, 'StaffIEN1001', 1001, 'StaffIEN1001', 10001, 'DrugIEN10001', 20001, 'METFORMIN HCL', 'METFORMIN HCL 500MG TAB', 'IP-2025-001002', '500MG', '500MG', 'PO', 'RouteIEN01', 'TAB', 'SCHEDULED', 'BID', 'TAB', 2001, 'WardIEN2001', '4 WEST MEDICAL', 'N', NULL, NULL, NULL, 'N', NULL, NULL, '2025-01-01 18:08:00', NULL, NULL),

-- Patient 1002 (InpatientSID 1638002) - PRN medication and variance (held)
(9004, 'BCMALogIEN9004', 508, 1002, 'PtIEN1002', 1638002, 'PFIEN002', 'GIVEN', 'COMPLETED', '2025-01-02 14:35:00', NULL, NULL, NULL, NULL, NULL, '2025-01-02 11:30:00', NULL, NULL, 1002, 'StaffIEN1002', 1002, 'StaffIEN1002', 10012, 'DrugIEN10012', 20012, 'HYDROCODONE-ACETAMINOPHEN', 'HYDROCODONE-ACETAMINOPHEN 5-325MG TAB', 'IP-2025-002001', '5-325MG', '5-325MG', 'PO', 'RouteIEN01', 'TAB', 'PRN', 'Q4H PRN', 'TAB', 2001, 'WardIEN2001', '4 WEST MEDICAL', 'N', NULL, NULL, NULL, 'N', NULL, NULL, '2025-01-02 14:35:00', NULL, NULL),
(9005, 'BCMALogIEN9005', 508, 1002, 'PtIEN1002', 1638002, 'PFIEN002', 'HELD', 'COMPLETED', '2025-01-02 20:05:00', NULL, NULL, '2025-01-02 20:00:00', NULL, NULL, '2025-01-02 11:30:00', NULL, NULL, 1001, 'StaffIEN1001', 1002, 'StaffIEN1002', 10009, 'DrugIEN10009', 20009, 'LEVOTHYROXINE SODIUM', 'LEVOTHYROXINE SODIUM 50MCG TAB', 'IP-2025-002002', '50MCG', NULL, 'PO', 'RouteIEN01', 'TAB', 'SCHEDULED', 'QD', 'TAB', 2001, 'WardIEN2001', '4 WEST MEDICAL', 'Y', 'HELD', 'PATIENT NPO FOR PROCEDURE', 'Patient NPO since midnight for surgery scheduled 0700 tomorrow', 'N', NULL, NULL, '2025-01-02 20:05:00', NULL, NULL),

-- Patient 1003 (InpatientSID 1638003) - Scheduled med and refused
(9006, 'BCMALogIEN9006', 508, 1003, 'PtIEN1003', 1638003, 'PFIEN003', 'GIVEN', 'COMPLETED', '2025-01-02 21:10:00', NULL, NULL, '2025-01-02 21:00:00', NULL, NULL, '2025-01-02 13:40:00', NULL, NULL, 1002, 'StaffIEN1002', 1001, 'StaffIEN1001', 10006, 'DrugIEN10006', 20006, 'SERTRALINE HCL', 'SERTRALINE HCL 100MG TAB', 'IP-2025-003001', '100MG', '100MG', 'PO', 'RouteIEN01', 'TAB', 'SCHEDULED', 'QHS', 'TAB', 2001, 'WardIEN2001', '4 WEST MEDICAL', 'N', NULL, NULL, NULL, 'N', NULL, NULL, '2025-01-02 21:10:00', NULL, NULL),
(9007, 'BCMALogIEN9007', 508, 1003, 'PtIEN1003', 1638003, 'PFIEN003', 'REFUSED', 'COMPLETED', '2025-01-03 08:10:00', NULL, NULL, '2025-01-03 08:00:00', NULL, NULL, '2025-01-02 13:40:00', NULL, NULL, 1001, 'StaffIEN1001', 1001, 'StaffIEN1001', 10006, 'DrugIEN10006', 20006, 'SERTRALINE HCL', 'SERTRALINE HCL 100MG TAB', 'IP-2025-003001', '100MG', NULL, 'PO', 'RouteIEN01', 'TAB', 'SCHEDULED', 'QD', 'TAB', 2001, 'WardIEN2001', '4 WEST MEDICAL', 'Y', 'REFUSED', 'PATIENT REFUSED', 'Patient states medication makes them feel nauseous. Provider notified.', 'N', NULL, NULL, '2025-01-03 08:10:00', NULL, NULL),

-- Patient 1004 (InpatientSID 1638004) - IV antibiotic with solution
(9008, 'BCMALogIEN9008', 508, 1004, 'PtIEN1004', 1638004, 'PFIEN004', 'GIVEN', 'COMPLETED', '2025-01-01 14:15:00', NULL, NULL, '2025-01-01 14:00:00', NULL, NULL, '2025-01-01 12:40:00', NULL, NULL, 1002, 'StaffIEN1002', 1002, 'StaffIEN1002', 15001, 'DrugIEN15001', 25001, 'CEFTRIAXONE SODIUM', 'CEFTRIAXONE SODIUM 1GM IVPB', 'IP-2025-004001', '1GM', '1GM', 'IV', 'RouteIEN02', 'IVPB', 'SCHEDULED', 'Q12H', 'IVPB', 2001, 'WardIEN2001', '4 WEST MEDICAL', 'N', NULL, NULL, NULL, 'Y', 'IVPB', '100ML/30MIN', '2025-01-01 14:15:00', NULL, NULL),
(9009, 'BCMALogIEN9009', 508, 1004, 'PtIEN1004', 1638004, 'PFIEN004', 'GIVEN', 'COMPLETED', '2025-01-02 02:10:00', NULL, NULL, '2025-01-02 02:00:00', NULL, NULL, '2025-01-01 12:40:00', NULL, NULL, 1001, 'StaffIEN1001', 1002, 'StaffIEN1002', 15001, 'DrugIEN15001', 25001, 'CEFTRIAXONE SODIUM', 'CEFTRIAXONE SODIUM 1GM IVPB', 'IP-2025-004001', '1GM', '1GM', 'IV', 'RouteIEN02', 'IVPB', 'SCHEDULED', 'Q12H', 'IVPB', 2001, 'WardIEN2001', '4 WEST MEDICAL', 'N', NULL, NULL, NULL, 'Y', 'IVPB', '100ML/30MIN', '2025-01-02 02:10:00', NULL, NULL),

-- Patient 1005 (InpatientSID 1638005) - Warfarin and missing dose
(9010, 'BCMALogIEN9010', 508, 1005, 'PtIEN1005', 1638005, 'PFIEN005', 'GIVEN', 'COMPLETED', '2025-01-03 17:05:00', NULL, NULL, '2025-01-03 17:00:00', NULL, NULL, '2025-01-03 12:50:00', NULL, NULL, 1001, 'StaffIEN1001', 1001, 'StaffIEN1001', 10010, 'DrugIEN10010', 20010, 'WARFARIN SODIUM', 'WARFARIN SODIUM 5MG TAB', 'IP-2025-005001', '5MG', '5MG', 'PO', 'RouteIEN01', 'TAB', 'SCHEDULED', 'QD', 'TAB', 2001, 'WardIEN2001', '4 WEST MEDICAL', 'N', NULL, NULL, NULL, 'N', NULL, NULL, '2025-01-03 17:05:00', NULL, NULL),
(9011, 'BCMALogIEN9011', 508, 1005, 'PtIEN1005', 1638005, 'PFIEN005', 'MISSING DOSE', 'COMPLETED', '2025-01-04 08:15:00', NULL, NULL, '2025-01-04 08:00:00', NULL, NULL, '2025-01-03 12:50:00', NULL, NULL, 1002, 'StaffIEN1002', 1001, 'StaffIEN1001', 10011, 'DrugIEN10011', 20011, 'METOPROLOL TARTRATE', 'METOPROLOL TARTRATE 50MG TAB', 'IP-2025-005002', '50MG', NULL, 'PO', 'RouteIEN01', 'TAB', 'SCHEDULED', 'BID', 'TAB', 2001, 'WardIEN2001', '4 WEST MEDICAL', 'Y', 'MISSING DOSE', 'NOT AVAILABLE FROM PHARMACY', 'Medication not available in unit stock. Pharmacy notified - will deliver STAT.', 'N', NULL, NULL, '2025-01-04 08:15:00', NULL, NULL),

-- Patient 1006 (InpatientSID 1638006) - Post-op pain meds
(9012, 'BCMALogIEN9012', 508, 1006, 'PtIEN1006', 1638006, 'PFIEN006', 'GIVEN', 'COMPLETED', '2025-01-02 11:20:00', NULL, NULL, NULL, NULL, NULL, '2025-01-02 09:15:00', NULL, NULL, 1002, 'StaffIEN1002', 1002, 'StaffIEN1002', 10012, 'DrugIEN10012', 20012, 'HYDROCODONE-ACETAMINOPHEN', 'HYDROCODONE-ACETAMINOPHEN 5-325MG TAB', 'IP-2025-006001', '5-325MG', '10-650MG', 'PO', 'RouteIEN01', 'TAB', 'PRN', 'Q4H PRN', 'TAB', 2001, 'WardIEN2001', '4 WEST MEDICAL', 'N', NULL, NULL, NULL, 'N', NULL, NULL, '2025-01-02 11:20:00', NULL, NULL),
(9013, 'BCMALogIEN9013', 508, 1006, 'PtIEN1006', 1638006, 'PFIEN006', 'GIVEN', 'COMPLETED', '2025-01-02 16:45:00', NULL, NULL, NULL, NULL, NULL, '2025-01-02 09:15:00', NULL, NULL, 1001, 'StaffIEN1001', 1002, 'StaffIEN1002', 10013, 'DrugIEN10013', 20013, 'IBUPROFEN', 'IBUPROFEN 600MG TAB', 'IP-2025-006002', '600MG', '600MG', 'PO', 'RouteIEN01', 'TAB', 'PRN', 'TID PRN', 'TAB', 2001, 'WardIEN2001', '4 WEST MEDICAL', 'N', NULL, NULL, NULL, 'N', NULL, NULL, '2025-01-02 16:45:00', NULL, NULL),

-- Patient 1007 (InpatientSID 1638007) - Sta3n 516 medications
(9014, 'BCMALogIEN9014', 516, 1007, 'PtIEN1007', 1638007, 'PFIEN007', 'GIVEN', 'COMPLETED', '2025-01-02 08:10:00', NULL, NULL, '2025-01-02 08:00:00', NULL, NULL, '2025-01-02 09:15:00', NULL, NULL, 1003, 'StaffIEN1003', 1003, 'StaffIEN1003', 10014, 'DrugIEN10014', 20014, 'OMEPRAZOLE', 'OMEPRAZOLE 20MG CAP DR', 'IP-2025-007001', '20MG', '20MG', 'PO', 'RouteIEN01', 'CAP', 'SCHEDULED', 'QD', 'CAP', 2002, 'WardIEN2002', '3 SOUTH MEDICAL', 'N', NULL, NULL, NULL, 'N', NULL, NULL, '2025-01-02 08:10:00', NULL, NULL),
(9015, 'BCMALogIEN9015', 516, 1007, 'PtIEN1007', 1638007, 'PFIEN007', 'GIVEN', 'COMPLETED', '2025-01-02 08:15:00', NULL, NULL, '2025-01-02 08:00:00', NULL, NULL, '2025-01-02 09:15:00', NULL, NULL, 1003, 'StaffIEN1003', 1003, 'StaffIEN1003', 10015, 'DrugIEN10015', 20015, 'ASPIRIN', 'ASPIRIN 81MG TAB EC', 'IP-2025-007002', '81MG', '81MG', 'PO', 'RouteIEN01', 'TAB', 'SCHEDULED', 'QD', 'TAB', 2002, 'WardIEN2002', '3 SOUTH MEDICAL', 'N', NULL, NULL, NULL, 'N', NULL, NULL, '2025-01-02 08:15:00', NULL, NULL),

-- Patient 1008 (InpatientSID 1638008) - Sta3n 516, IV continuous infusion
(9016, 'BCMALogIEN9016', 516, 1008, 'PtIEN1008', 1638008, 'PFIEN008', 'GIVEN', 'COMPLETED', '2025-01-01 16:00:00', NULL, NULL, '2025-01-01 16:00:00', NULL, NULL, '2025-01-01 15:45:00', NULL, NULL, 1004, 'StaffIEN1004', 1004, 'StaffIEN1004', 15002, 'DrugIEN15002', 25002, 'NORMAL SALINE', 'NORMAL SALINE 0.9% 1000ML', 'IP-2025-008001', '1000ML', '1000ML', 'IV', 'RouteIEN02', 'BAG', 'CONTINUOUS', 'CONTINUOUS', 'BAG', 2002, 'WardIEN2002', '3 SOUTH MEDICAL', 'N', NULL, NULL, NULL, 'Y', 'CONTINUOUS', '125ML/HR', '2025-01-01 16:00:00', NULL, NULL),
(9017, 'BCMALogIEN9017', 516, 1008, 'PtIEN1008', 1638008, 'PFIEN008', 'GIVEN', 'COMPLETED', '2025-01-01 20:10:00', NULL, NULL, '2025-01-01 20:00:00', NULL, NULL, '2025-01-01 15:50:00', NULL, NULL, 1003, 'StaffIEN1003', 1004, 'StaffIEN1004', 10016, 'DrugIEN10016', 20016, 'GABAPENTIN', 'GABAPENTIN 300MG CAP', 'IP-2025-008002', '300MG', '300MG', 'PO', 'RouteIEN01', 'CAP', 'SCHEDULED', 'TID', 'CAP', 2002, 'WardIEN2002', '3 SOUTH MEDICAL', 'N', NULL, NULL, NULL, 'N', NULL, NULL, '2025-01-01 20:10:00', NULL, NULL),

-- Additional IV medication with additives (Patient 1004)
(9018, 'BCMALogIEN9018', 508, 1004, 'PtIEN1004', 1638004, 'PFIEN004', 'GIVEN', 'COMPLETED', '2025-01-02 08:00:00', NULL, NULL, '2025-01-02 08:00:00', NULL, NULL, '2025-01-01 12:50:00', NULL, NULL, 1002, 'StaffIEN1002', 1002, 'StaffIEN1002', 15003, 'DrugIEN15003', 25003, 'POTASSIUM CHLORIDE', 'POTASSIUM CHLORIDE 20MEQ IN D5W 1000ML', 'IP-2025-004002', '20MEQ', '20MEQ', 'IV', 'RouteIEN02', 'BAG', 'SCHEDULED', 'Q12H', 'BAG', 2001, 'WardIEN2001', '4 WEST MEDICAL', 'N', NULL, NULL, NULL, 'Y', 'IVPB', '100ML/HR', '2025-01-02 08:00:00', NULL, NULL),

-- Additional scheduled meds with late administration variance
(9019, 'BCMALogIEN9019', 508, 1001, 'PtIEN1001', 1638001, 'PFIEN001', 'GIVEN', 'COMPLETED', '2025-01-02 08:45:00', NULL, NULL, '2025-01-02 08:00:00', NULL, NULL, '2025-01-01 03:45:00', NULL, NULL, 1001, 'StaffIEN1001', 1001, 'StaffIEN1001', 10002, 'DrugIEN10002', 20002, 'LISINOPRIL', 'LISINOPRIL 10MG TAB', 'IP-2025-001001', '10MG', '10MG', 'PO', 'RouteIEN01', 'TAB', 'SCHEDULED', 'QD', 'TAB', 2001, 'WardIEN2001', '4 WEST MEDICAL', 'Y', 'LATE', 'PATIENT OFF UNIT', 'Patient at diagnostic imaging. Med given upon return to unit.', 'N', NULL, NULL, '2025-01-02 08:45:00', NULL, NULL),

-- Insulin administration (Patient 1002)
(9020, 'BCMALogIEN9020', 508, 1002, 'PtIEN1002', 1638002, 'PFIEN002', 'GIVEN', 'COMPLETED', '2025-01-02 07:30:00', NULL, NULL, '2025-01-02 07:00:00', NULL, NULL, '2025-01-02 11:35:00', NULL, NULL, 1002, 'StaffIEN1002', 1002, 'StaffIEN1002', 10019, 'DrugIEN10019', 20019, 'INSULIN GLARGINE', 'INSULIN GLARGINE 100UNIT/ML INJ', 'IP-2025-002003', '10UNITS', '10UNITS', 'SC', 'RouteIEN03', 'UNITS', 'SCHEDULED', 'BID', 'UNITS', 2001, 'WardIEN2001', '4 WEST MEDICAL', 'N', NULL, NULL, NULL, 'N', NULL, NULL, '2025-01-02 07:30:00', NULL, NULL);
GO
