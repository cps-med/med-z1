/*
|--------------------------------------------------------------------------------
| Insert: RxOut.RxOutpat.sql
|--------------------------------------------------------------------------------
| Insert test prescription data
| RxOutpatSID => 5001 series
| Prescriptions linked to existing patients (1001-1010) and providers (1001-1006)
| Includes chronic medications, acute medications, and controlled substances
|--------------------------------------------------------------------------------
*/

PRINT '==== RxOut.RxOutpat ====';
GO

-- Set the active database
USE CDWWork;
GO

-- Insert prescription data into RxOut.RxOutpat table
INSERT INTO RxOut.RxOutpat
(
  RxOutpatSID, RxOutpatIEN, Sta3n, PatientSID, PatientIEN, LocalDrugSID, LocalDrugIEN, NationalDrugSID, DrugNameWithoutDose, DrugNameWithDose, PrescriptionNumber, IssueDateTime, IssueVistaErrorDate, IssueDateTimeTransformSID, ProviderSID, ProviderIEN, OrderingProviderSID, OrderingProviderIEN, EnteredByStaffSID, EnteredByStaffIEN, PharmacySID, PharmacyIEN, PharmacyName, RxStatus, RxType, Quantity, DaysSupply, RefillsAllowed, RefillsRemaining, MaxRefills, UnitDose, ExpirationDateTime, ExpirationVistaErrorDate, ExpirationDateTimeTransformSID, DiscontinuedDateTime, DiscontinuedVistaErrorDate, DiscontinuedDateTimeTransformSID, DiscontinueReason, DiscontinuedByStaffSID, LoginDateTime, LoginVistaErrorDate, LoginDateTimeTransformSID, ClinicSID, ClinicIEN, ClinicName, DEASchedule, ControlledSubstanceFlag, CMOPIndicator, MailIndicator
)
VALUES
-- Patient 1001 (Adam Dooree) - Chronic medications for diabetes/hypertension
(5001, 'RxIEN5001', 508, 1001, 'PtIEN1001', 10001, 'DrugIEN10001', 20001, 'METFORMIN HCL', 'METFORMIN HCL 500MG TAB', '2024-001-0001', '2025-01-15 10:30:00', NULL, NULL, 1001, 'StaffIEN1001', 1001, 'StaffIEN1001', 1001, 'StaffIEN1001', 5001, 'PharmIEN5001', 'VA PORTLAND MAIN PHARMACY', 'ACTIVE', 'MAIL', 180, 90, 5, 3, 5, '1 TAB', '2025-01-15 00:00:00', NULL, NULL, NULL, NULL, NULL, NULL, NULL, '2025-01-15 10:30:00', NULL, NULL, 8001, 'ClinicIEN8001', 'PRIMARY CARE CLINIC', NULL, 'N', 'Y', 'Y'),
(5002, 'RxIEN5002', 508, 1001, 'PtIEN1001', 10002, 'DrugIEN10002', 20002, 'LISINOPRIL', 'LISINOPRIL 10MG TAB', '2024-001-0002', '2025-01-15 10:35:00', NULL, NULL, 1001, 'StaffIEN1001', 1001, 'StaffIEN1001', 1001, 'StaffIEN1001', 5001, 'PharmIEN5001', 'VA PORTLAND MAIN PHARMACY', 'ACTIVE', 'MAIL', 90, 90, 5, 4, 5, '1 TAB', '2025-01-15 00:00:00', NULL, NULL, NULL, NULL, NULL, NULL, NULL, '2025-01-15 10:35:00', NULL, NULL, 8001, 'ClinicIEN8001', 'PRIMARY CARE CLINIC', NULL, 'N', 'Y', 'Y'),
(5003, 'RxIEN5003', 508, 1001, 'PtIEN1001', 10003, 'DrugIEN10003', 20003, 'ATORVASTATIN CALCIUM', 'ATORVASTATIN CALCIUM 20MG TAB', '2024-001-0003', '2024-02-20 14:15:00', NULL, NULL, 1001, 'StaffIEN1001', 1001, 'StaffIEN1001', 1001, 'StaffIEN1001', 5001, 'PharmIEN5001', 'VA PORTLAND MAIN PHARMACY', 'ACTIVE', 'MAIL', 90, 90, 5, 5, 5, '1 TAB', '2025-02-20 00:00:00', NULL, NULL, NULL, NULL, NULL, NULL, NULL, '2024-02-20 14:15:00', NULL, NULL, 8001, 'ClinicIEN8001', 'PRIMARY CARE CLINIC', NULL, 'N', 'Y', 'Y'),

-- Patient 1002 (Barry Miifaa) - COPD and pain management
(5004, 'RxIEN5004', 508, 1002, 'PtIEN1002', 10004, 'DrugIEN10004', 20004, 'ALBUTEROL SULFATE', 'ALBUTEROL SULFATE HFA 90MCG INHALER', '2024-002-0001', '2025-01-22 09:15:00', NULL, NULL, 1002, 'StaffIEN1002', 1002, 'StaffIEN1002', 1002, 'StaffIEN1002', 5001, 'PharmIEN5001', 'VA PORTLAND MAIN PHARMACY', 'ACTIVE', 'WINDOW', 1, 30, 11, 8, 11, '1 INH', '2025-01-22 00:00:00', NULL, NULL, NULL, NULL, NULL, NULL, NULL, '2025-01-22 09:15:00', NULL, NULL, 8002, 'ClinicIEN8002', 'PULMONARY CLINIC', NULL, 'N', 'N', 'N'),
(5005, 'RxIEN5005', 508, 1002, 'PtIEN1002', 10005, 'DrugIEN10005', 20005, 'TRAMADOL HCL', 'TRAMADOL HCL 50MG TAB', '2024-002-0002', '2024-03-10 11:45:00', NULL, NULL, 1002, 'StaffIEN1002', 1002, 'StaffIEN1002', 1002, 'StaffIEN1002', 5001, 'PharmIEN5001', 'VA PORTLAND MAIN PHARMACY', 'ACTIVE', 'WINDOW', 60, 30, 2, 2, 2, '1 TAB', '2024-09-10 00:00:00', NULL, NULL, NULL, NULL, NULL, NULL, NULL, '2024-03-10 11:45:00', NULL, NULL, 8003, 'ClinicIEN8003', 'PAIN MANAGEMENT CLINIC', 'C-IV', 'Y', 'N', 'N'),

-- Patient 1003 (Carol Soolaa) - Anxiety and depression
(5006, 'RxIEN5006', 508, 1003, 'PtIEN1003', 10006, 'DrugIEN10006', 20006, 'SERTRALINE HCL', 'SERTRALINE HCL 100MG TAB', '2024-003-0001', '2025-02-05 13:20:00', NULL, NULL, 1001, 'StaffIEN1001', 1001, 'StaffIEN1001', 1001, 'StaffIEN1001', 5001, 'PharmIEN5001', 'VA PORTLAND MAIN PHARMACY', 'ACTIVE', 'MAIL', 90, 90, 5, 5, 5, '1 TAB', '2025-02-05 00:00:00', NULL, NULL, NULL, NULL, NULL, NULL, NULL, '2025-02-05 13:20:00', NULL, NULL, 8004, 'ClinicIEN8004', 'MENTAL HEALTH CLINIC', NULL, 'N', 'Y', 'Y'),
(5007, 'RxIEN5007', 508, 1003, 'PtIEN1003', 10007, 'DrugIEN10007', 20007, 'ALPRAZOLAM', 'ALPRAZOLAM 0.5MG TAB', '2024-003-0002', '2025-02-05 13:25:00', NULL, NULL, 1001, 'StaffIEN1001', 1001, 'StaffIEN1001', 1001, 'StaffIEN1001', 5001, 'PharmIEN5001', 'VA PORTLAND MAIN PHARMACY', 'DISCONTINUED', 'WINDOW', 30, 30, 0, 0, 0, '1 TAB', '2024-08-05 00:00:00', NULL, NULL, '2024-06-15 00:00:00', NULL, NULL, 'CHANGED TO NON-CONTROLLED ALTERNATIVE', 1001, '2025-02-05 13:25:00', NULL, NULL, 8004, 'ClinicIEN8004', 'MENTAL HEALTH CLINIC', 'C-IV', 'Y', 'N', 'N'),

-- Patient 1004 (Debby Tiidoo) - Acute antibiotic
(5008, 'RxIEN5008', 508, 1004, 'PtIEN1004', 10008, 'DrugIEN10008', 20008, 'AMOXICILLIN', 'AMOXICILLIN 500MG CAP', '2024-004-0001', '2025-03-12 15:30:00', NULL, NULL, 1002, 'StaffIEN1002', 1002, 'StaffIEN1002', 1002, 'StaffIEN1002', 5001, 'PharmIEN5001', 'VA PORTLAND MAIN PHARMACY', 'EXPIRED', 'WINDOW', 21, 7, 0, 0, 0, '1 CAP', '2024-09-12 00:00:00', NULL, NULL, NULL, NULL, NULL, NULL, NULL, '2025-03-12 15:30:00', NULL, NULL, 8001, 'ClinicIEN8001', 'PRIMARY CARE CLINIC', NULL, 'N', 'N', 'N'),
(5009, 'RxIEN5009', 508, 1004, 'PtIEN1004', 10009, 'DrugIEN10009', 20009, 'LEVOTHYROXINE SODIUM', 'LEVOTHYROXINE SODIUM 50MCG TAB', '2024-004-0002', '2024-01-18 10:00:00', NULL, NULL, 1002, 'StaffIEN1002', 1002, 'StaffIEN1002', 1002, 'StaffIEN1002', 5001, 'PharmIEN5001', 'VA PORTLAND MAIN PHARMACY', 'ACTIVE', 'MAIL', 90, 90, 5, 4, 5, '1 TAB', '2025-01-18 00:00:00', NULL, NULL, NULL, NULL, NULL, NULL, NULL, '2024-01-18 10:00:00', NULL, NULL, 8001, 'ClinicIEN8001', 'PRIMARY CARE CLINIC', NULL, 'N', 'Y', 'Y'),

-- Patient 1005 (Edward Dooree) - Cardiology meds
(5010, 'RxIEN5010', 508, 1005, 'PtIEN1005', 10010, 'DrugIEN10010', 20010, 'WARFARIN SODIUM', 'WARFARIN SODIUM 5MG TAB', '2024-005-0001', '2025-01-25 09:30:00', NULL, NULL, 1001, 'StaffIEN1001', 1001, 'StaffIEN1001', 1001, 'StaffIEN1001', 5001, 'PharmIEN5001', 'VA PORTLAND MAIN PHARMACY', 'ACTIVE', 'WINDOW', 90, 90, 11, 11, 11, '1 TAB', '2025-01-25 00:00:00', NULL, NULL, NULL, NULL, NULL, NULL, NULL, '2025-01-25 09:30:00', NULL, NULL, 8005, 'ClinicIEN8005', 'CARDIOLOGY CLINIC', NULL, 'N', 'N', 'N'),
(5011, 'RxIEN5011', 508, 1005, 'PtIEN1005', 10011, 'DrugIEN10011', 20011, 'METOPROLOL TARTRATE', 'METOPROLOL TARTRATE 50MG TAB', '2024-005-0002', '2025-01-25 09:35:00', NULL, NULL, 1001, 'StaffIEN1001', 1001, 'StaffIEN1001', 1001, 'StaffIEN1001', 5001, 'PharmIEN5001', 'VA PORTLAND MAIN PHARMACY', 'ACTIVE', 'MAIL', 180, 90, 5, 5, 5, '1 TAB', '2025-01-25 00:00:00', NULL, NULL, NULL, NULL, NULL, NULL, NULL, '2025-01-25 09:35:00', NULL, NULL, 8005, 'ClinicIEN8005', 'CARDIOLOGY CLINIC', NULL, 'N', 'Y', 'Y'),

-- Patient 1006 (Francine Miifaa) - Post-surgical pain
(5012, 'RxIEN5012', 508, 1006, 'PtIEN1006', 10012, 'DrugIEN10012', 20012, 'HYDROCODONE-ACETAMINOPHEN', 'HYDROCODONE-ACETAMINOPHEN 5-325MG TAB', '2024-006-0001', '2025-04-10 14:20:00', NULL, NULL, 1002, 'StaffIEN1002', 1002, 'StaffIEN1002', 1002, 'StaffIEN1002', 5001, 'PharmIEN5001', 'VA PORTLAND MAIN PHARMACY', 'EXPIRED', 'WINDOW', 30, 10, 0, 0, 0, '1 TAB', '2024-10-10 00:00:00', NULL, NULL, NULL, NULL, NULL, NULL, NULL, '2025-04-10 14:20:00', NULL, NULL, 8006, 'ClinicIEN8006', 'SURGICAL CLINIC', 'C-II', 'Y', 'N', 'N'),
(5013, 'RxIEN5013', 508, 1006, 'PtIEN1006', 10013, 'DrugIEN10013', 20013, 'IBUPROFEN', 'IBUPROFEN 600MG TAB', '2024-006-0002', '2025-04-10 14:25:00', NULL, NULL, 1002, 'StaffIEN1002', 1002, 'StaffIEN1002', 1002, 'StaffIEN1002', 5001, 'PharmIEN5001', 'VA PORTLAND MAIN PHARMACY', 'EXPIRED', 'WINDOW', 60, 20, 1, 0, 1, '1 TAB', '2024-10-10 00:00:00', NULL, NULL, NULL, NULL, NULL, NULL, NULL, '2025-04-10 14:25:00', NULL, NULL, 8006, 'ClinicIEN8006', 'SURGICAL CLINIC', NULL, 'N', 'N', 'N'),

-- Patient 1007 (Adam Amajor) - Sta3n 516
(5014, 'RxIEN5014', 516, 1007, 'PtIEN1007', 10014, 'DrugIEN10014', 20014, 'OMEPRAZOLE', 'OMEPRAZOLE 20MG CAP DR', '2024-007-0001', '2025-02-08 11:15:00', NULL, NULL, 1003, 'StaffIEN1003', 1003, 'StaffIEN1003', 1003, 'StaffIEN1003', 5002, 'PharmIEN5002', 'VA TACOMA MAIN PHARMACY', 'ACTIVE', 'MAIL', 90, 90, 5, 4, 5, '1 CAP', '2025-02-08 00:00:00', NULL, NULL, NULL, NULL, NULL, NULL, NULL, '2025-02-08 11:15:00', NULL, NULL, 8007, 'ClinicIEN8007', 'GASTROENTEROLOGY CLINIC', NULL, 'N', 'Y', 'Y'),
(5015, 'RxIEN5015', 516, 1007, 'PtIEN1007', 10015, 'DrugIEN10015', 20015, 'ASPIRIN', 'ASPIRIN 81MG TAB EC', '2024-007-0002', '2025-02-08 11:20:00', NULL, NULL, 1003, 'StaffIEN1003', 1003, 'StaffIEN1003', 1003, 'StaffIEN1003', 5002, 'PharmIEN5002', 'VA TACOMA MAIN PHARMACY', 'ACTIVE', 'MAIL', 90, 90, 5, 5, 5, '1 TAB', '2025-02-08 00:00:00', NULL, NULL, NULL, NULL, NULL, NULL, NULL, '2025-02-08 11:20:00', NULL, NULL, 8005, 'ClinicIEN8005', 'CARDIOLOGY CLINIC', NULL, 'N', 'Y', 'Y'),

-- Patient 1008 (Barry Bmajor) - Sta3n 516
(5016, 'RxIEN5016', 516, 1008, 'PtIEN1008', 10016, 'DrugIEN10016', 20016, 'GABAPENTIN', 'GABAPENTIN 300MG CAP', '2024-008-0001', '2025-03-15 10:45:00', NULL, NULL, 1004, 'StaffIEN1004', 1004, 'StaffIEN1004', 1004, 'StaffIEN1004', 5002, 'PharmIEN5002', 'VA TACOMA MAIN PHARMACY', 'ACTIVE', 'MAIL', 270, 90, 5, 4, 5, '1 CAP', '2025-03-15 00:00:00', NULL, NULL, NULL, NULL, NULL, NULL, NULL, '2025-03-15 10:45:00', NULL, NULL, 8003, 'ClinicIEN8003', 'PAIN MANAGEMENT CLINIC', NULL, 'N', 'Y', 'Y'),

-- Patient 1009 (Claire Cmajor) - Sta3n 516
(5017, 'RxIEN5017', 516, 1009, 'PtIEN1009', 10017, 'DrugIEN10017', 20017, 'AMLODIPINE BESYLATE', 'AMLODIPINE BESYLATE 5MG TAB', '2024-009-0001', '2025-01-30 14:30:00', NULL, NULL, 1003, 'StaffIEN1003', 1003, 'StaffIEN1003', 1003, 'StaffIEN1003', 5002, 'PharmIEN5002', 'VA TACOMA MAIN PHARMACY', 'ACTIVE', 'MAIL', 90, 90, 5, 5, 5, '1 TAB', '2025-01-30 00:00:00', NULL, NULL, NULL, NULL, NULL, NULL, NULL, '2025-01-30 14:30:00', NULL, NULL, 8001, 'ClinicIEN8001', 'PRIMARY CARE CLINIC', NULL, 'N', 'Y', 'Y'),
(5018, 'RxIEN5018', 516, 1009, 'PtIEN1009', 10018, 'DrugIEN10018', 20018, 'LOSARTAN POTASSIUM', 'LOSARTAN POTASSIUM 50MG TAB', '2024-009-0002', '2025-01-30 14:35:00', NULL, NULL, 1003, 'StaffIEN1003', 1003, 'StaffIEN1003', 1003, 'StaffIEN1003', 5002, 'PharmIEN5002', 'VA TACOMA MAIN PHARMACY', 'ACTIVE', 'MAIL', 90, 90, 5, 5, 5, '1 TAB', '2025-01-30 00:00:00', NULL, NULL, NULL, NULL, NULL, NULL, NULL, '2025-01-30 14:35:00', NULL, NULL, 8001, 'ClinicIEN8001', 'PRIMARY CARE CLINIC', NULL, 'N', 'Y', 'Y'),

-- Patient 1010 (Alexander Aminor) - Sta3n 552
(5019, 'RxIEN5019', 552, 1010, 'PtIEN1010', 10019, 'DrugIEN10019', 20019, 'INSULIN GLARGINE', 'INSULIN GLARGINE 100UNIT/ML INJ', '2024-010-0001', '2025-02-12 09:00:00', NULL, NULL, 1005, 'StaffIEN1005', 1005, 'StaffIEN1005', 1005, 'StaffIEN1005', 5003, 'PharmIEN5003', 'VA SEATTLE MAIN PHARMACY', 'ACTIVE', 'WINDOW', 3, 30, 2, 2, 2, '1 VIAL', '2024-08-12 00:00:00', NULL, NULL, NULL, NULL, NULL, NULL, NULL, '2025-02-12 09:00:00', NULL, NULL, 8008, 'ClinicIEN8008', 'ENDOCRINOLOGY CLINIC', NULL, 'N', 'N', 'N'),
(5020, 'RxIEN5020', 552, 1010, 'PtIEN1010', 10020, 'DrugIEN10020', 20020, 'METFORMIN HCL', 'METFORMIN HCL 1000MG TAB', '2024-010-0002', '2025-02-12 09:05:00', NULL, NULL, 1005, 'StaffIEN1005', 1005, 'StaffIEN1005', 1005, 'StaffIEN1005', 5003, 'PharmIEN5003', 'VA SEATTLE MAIN PHARMACY', 'ACTIVE', 'MAIL', 180, 90, 5, 5, 5, '1 TAB', '2025-02-12 00:00:00', NULL, NULL, NULL, NULL, NULL, NULL, NULL, '2025-02-12 09:05:00', NULL, NULL, 8008, 'ClinicIEN8008', 'ENDOCRINOLOGY CLINIC', NULL, 'N', 'Y', 'Y');
GO

-- Adding record for for Patient 1005 (already has WARFARIN, add ASPIRIN for interaction
-- This creates a WARFARIN + ASPIRIN interaction for Patient 1005
-- Expected DDI: Increased bleeding risk

INSERT INTO RxOut.RxOutpat
(
  RxOutpatSID, RxOutpatIEN, Sta3n, PatientSID, PatientIEN, LocalDrugSID, LocalDrugIEN, NationalDrugSID, DrugNameWithoutDose, DrugNameWithDose, PrescriptionNumber, IssueDateTime, ProviderSID, ProviderIEN, OrderingProviderSID, OrderingProviderIEN, PharmacySID, PharmacyIEN, PharmacyName, RxStatus, RxType, Quantity, DaysSupply, RefillsAllowed, RefillsRemaining, MaxRefills, UnitDose, ExpirationDateTime
)
VALUES
(5021, 'RxIEN5021', 508, 1005, 'PtIEN1005',  10021, 'DrugIEN10021', 20021, 'ACETYLSALICYLIC ACID', 'ACETYLSALICYLIC ACID 81MG TAB', '2024-005-0003', '2025-02-01 10:00:00', 1001, 'StaffIEN1001', 1001, 'StaffIEN1001', 5001, 'PharmIEN5001', 'VA PORTLAND MAIN PHARMACY', 'ACTIVE', 'WINDOW', 90, 90, 11, 11, 11, '1 TAB', '2025-02-01 00:00:00');
GO

-- Adding record for Patient 1001 (already has LISINOPRIL, add SPIRONOLACTONE for interaction)
-- This creates a LISINOPRIL + SPIRONOLACTONE interaction for Patient 1001
-- Expected DDI: Increased risk of hyperkalemia (high potassium levels)

INSERT INTO RxOut.RxOutpat
(
  RxOutpatSID, RxOutpatIEN, Sta3n, PatientSID, PatientIEN, LocalDrugSID, LocalDrugIEN, NationalDrugSID, DrugNameWithoutDose, DrugNameWithDose, PrescriptionNumber, IssueDateTime, ProviderSID, ProviderIEN, OrderingProviderSID, OrderingProviderIEN, PharmacySID, PharmacyIEN, PharmacyName, RxStatus, RxType, Quantity, DaysSupply, RefillsAllowed, RefillsRemaining, MaxRefills, UnitDose, ExpirationDateTime
)
VALUES
(5022, 'RxIEN5022', 508, 1001, 'PtIEN1001', 10022, 'DrugIEN10022', 20022, 'SPIRONOLACTONE', 'SPIRONOLACTONE 25MG TAB', '2024-001-0004', '2025-03-01 10:00:00', 1001, 'StaffIEN1001', 1001, 'StaffIEN1001', 5001, 'PharmIEN5001', 'VA PORTLAND MAIN PHARMACY', 'ACTIVE', 'MAIL', 90, 90, 5, 5, 5, '1 TAB', '2025-03-01 00:00:00');
GO
